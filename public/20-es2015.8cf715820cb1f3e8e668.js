(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{P7AT:function(e,t,n){"use strict";n.r(t),n.d(t,"CargarHorarioPageModule",(function(){return I}));var i=n("ofXK"),s=n("3Pt+"),o=n("TEn/"),c=n("tyNb"),a=n("mrSG"),r=n("EUZL"),l=n("fXoL"),b=n("LMH3"),h=n("ex6u"),u=n("p/K2");function d(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-list"),l.Qb(1,"ion-item"),l.Qb(2,"ion-label"),l.oc(3),l.Pb(),l.Qb(4,"ion-checkbox",5),l.Yb("ngModelChange",(function(n){return l.jc(e),t.$implicit.isChecked=n}))("ionChange",(function(){return l.jc(e),l.ac(2).onChange()})),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit;l.zb(3),l.pc(e.name),l.zb(1),l.fc("ngModel",e.isChecked)}}function f(e,t){if(1&e&&(l.Qb(0,"ion-content"),l.mc(1,d,5,2,"ion-list",4),l.Pb()),2&e){const e=l.ac();l.zb(1),l.fc("ngForOf",e.careers)}}function m(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Mb(1,"ion-icon",8),l.Qb(2,"ion-checkbox",5),l.Yb("ngModelChange",(function(n){return l.jc(e),t.$implicit.isItemChecked=n}))("ionChange",(function(){l.jc(e);const t=l.ac().index;return l.ac(2).verifyEvent(t)})),l.Pb(),l.Qb(3,"ion-label"),l.oc(4),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit;l.zb(2),l.fc("ngModel",e.isItemChecked),l.zb(2),l.pc(e.nombre)}}function g(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-list"),l.Qb(1,"ion-grid"),l.Qb(2,"ion-row"),l.Qb(3,"ion-item",6),l.Qb(4,"ion-checkbox",7),l.Yb("ngModelChange",(function(n){return l.jc(e),t.$implicit.checkParent=n}))("click",(function(n){l.jc(e);const i=t.index;return l.ac(2).checkCheckbox(n,i)})),l.Pb(),l.Pb(),l.Qb(5,"ion-item"),l.Qb(6,"ion-label"),l.Qb(7,"strong"),l.oc(8),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.mc(9,m,5,2,"ion-item",4),l.Pb()}if(2&e){const e=t.$implicit,n=t.index;l.zb(4),l.fc("ngModel",e.checkParent)("indeterminate",e.indeterminateState),l.zb(4),l.qc("Semestre ",n+1,""),l.zb(1),l.fc("ngForOf",e.materias)}}function C(e,t){if(1&e&&(l.Qb(0,"ion-content"),l.mc(1,g,10,4,"ion-list",4),l.Pb()),2&e){const e=l.ac();l.zb(1),l.fc("ngForOf",e.semestersClasses)}}function p(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item"),l.Mb(1,"ion-icon",8),l.Qb(2,"ion-checkbox",9),l.Yb("ngModelChange",(function(n){return l.jc(e),t.$implicit.isItemChecked=n})),l.Pb(),l.Qb(3,"ion-label"),l.Qb(4,"h2"),l.oc(5),l.Pb(),l.Qb(6,"h2"),l.oc(7),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit;l.zb(2),l.fc("ngModel",e.isItemChecked),l.zb(3),l.pc(e.nombre),l.zb(2),l.rc(" ",e.seccion," - ",e.profesor," ")}}function P(e,t){if(1&e&&(l.Qb(0,"ion-list"),l.Qb(1,"ion-grid"),l.Qb(2,"ion-row"),l.Mb(3,"ion-item",6),l.Qb(4,"ion-item"),l.Qb(5,"ion-label"),l.Qb(6,"strong"),l.oc(7),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.mc(8,p,8,4,"ion-item",4),l.Pb()),2&e){const e=t.$implicit;l.zb(7),l.sc("",e.padre," - ",e.sigla,"","-- --"==e.enf?"":"-"+e.enf,""),l.zb(1),l.fc("ngForOf",e.hijos)}}function k(e,t){if(1&e&&(l.Qb(0,"ion-content"),l.mc(1,P,9,4,"ion-list",4),l.Pb()),2&e){const e=l.ac();l.zb(1),l.fc("ngForOf",e.selectedClassForView)}}function Q(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item",10),l.Yb("click",(function(){return l.jc(e),l.ac().nextPage()})),l.Qb(1,"ion-label"),l.oc(2,"SIGUIENTE"),l.Pb(),l.Mb(3,"ion-icon",11),l.Pb()}}function S(e,t){if(1&e){const e=l.Rb();l.Qb(0,"ion-item",12),l.Yb("click",(function(){return l.jc(e),l.ac().previousPage()})),l.Mb(1,"ion-icon",13),l.Qb(2,"ion-label"),l.oc(3,"ATRAS"),l.Pb(),l.Pb()}}const w=[{path:"",component:(()=>{class e{constructor(e,t,n){this.fpuna=e,this.alertController=t,this.router=n,this.currentSection={number:1,nextPageVisibility:!0,prePageVisibility:!1},this.initialize()}initialize(){this.getData()}getData(){this.fpuna.getCarrerasAll().subscribe(e=>{this.careers=e,console.log(e)})}onChange(){let e=[];this.careers.forEach(t=>{t.isChecked&&e.push({code:t.code,enf:t.enf,id:t._id})}),this.selectedCareer=e,console.log("tonextpage",e)}loadSection2(){let e=this.selectedCareer[0].id;console.log("this.selectedCareer",this.selectedCareer),this.fpuna.getClasesAll().subscribe(t=>{let n=[];t.forEach(t=>{t.career_id==e&&(n[t.semester-1]||(n[t.semester-1]={materias:[]}),n[t.semester-1].materias.push({nombre:t.name}))}),this.semestersClasses=n,console.log("this.semestersClassse",n)})}checkCheckbox(e,t){setTimeout(()=>{this.semestersClasses[t].materias.forEach(e=>{e.isItemChecked=this.semestersClasses[t].checkParent})})}verifyEvent(e){const t=this.semestersClasses[e].materias.length;let n=0;this.semestersClasses[e].materias.map(e=>{e.isItemChecked&&n++}),n>0&&n<t?(this.semestersClasses[e].indeterminateState=!0,this.semestersClasses[e].checkParent=!1):n==t?(this.semestersClasses[e].checkParent=!0,this.semestersClasses[e].indeterminateState=!1):(this.semestersClasses[e].indeterminateState=!1,this.semestersClasses[e].checkParent=!1)}loadSection3(){this.seletedClassName=function(e){let t=[];return e.forEach(e=>{e.materias.forEach(e=>{e.isItemChecked&&t.push(e.nombre)})}),t}(this.semestersClasses)}readFilePopup(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:"Seleccionar Horario",message:"<button>Message <strong>text</strong></button>!!!",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"Buscar",handler:()=>{document.getElementById("file-input").click()}}]});yield e.present()}))}onFileChange(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");const n=new FileReader;n.onload=e=>{let t=this.selectedCareer[0];this.dataFromExcel=function(e,t){const n=r.read(e,{type:"binary"}),i=t.code;console.log("sheet",i);let s=[];return s=r.utils.sheet_to_json(n.Sheets[i],{header:1,range:11}),s}(e.target.result,t),console.log("Class Name",this.seletedClassName);let n=function(e,t,n){let i=[],s=[];return e.forEach(e=>{t.forEach(t=>{if(function(e,t,n){let i=e[2].includes(t),s=e[2]===t,o=" "==e[2][t.length],c=void 0===e[6]||"-- --"===e[6]||e[6].includes(n);return i&&(s||o)&&c}(e,t,n.enf)){let o=s.findIndex(e=>e.padre===t);-1==o&&(o=s.push({padre:t,sigla:e[5],enf:n.enf,hijos:[]})-1),s[o].hijos.push({id:e[0],nombre:e[2].split("(*)")[0].split("-")[1],def:e[2].split("(*)")[1],seccion:e[9],profesor:`${e[10]} ${e[12]} ${e[11]}`}),i.push(e)}})}),console.log(s),{all:i,forView:s}}(this.dataFromExcel,this.seletedClassName,t);this.selectedClass=n.all,this.selectedClassForView=n.forView,console.log("selectedClass",this.selectedClass)},this.FileName=t.files[0].name,n.readAsBinaryString(t.files[0])}nextPage(){switch(this.currentSection.number++,this.currentSection.prePageVisibility=!0,this.currentSection.number){case 2:this.loadSection2();break;case 3:this.readFilePopup(),this.loadSection3();break;case 4:this.endPage(),this.router.navigate(["/"])}}previousPage(){this.currentSection.number--,1==this.currentSection.number&&(this.currentSection.prePageVisibility=!1)}endPage(){console.log("selectedClass",this.selectedClass),console.log("selectedClass",JSON.stringify(this.selectedClass)),console.log("selectedClassForView",this.selectedClassForView),console.log("selectedClassForView",JSON.stringify(this.selectedClassForView));let e=[];this.selectedClassForView.forEach(t=>{t.hijos.forEach(t=>{if(t.isItemChecked){let n=this.selectedClass.find(e=>t.id===e[0]);e.push(n)}})}),e=function(e){let t=[];return e.forEach(e=>{t.push({item:e[0],dpto:e[1],asignatura:e[2],nivel:e[3],sem:e[4],sigla:e[5],enfasis:e[6],plan:e[7],turno:e[8],seccion:e[9],tit:e[10],apellido:e[11],nombre:e[12],"1p":{dia:e[13],hora:e[14],aula:e[15]},"2p":{dia:e[16],hora:e[17],aula:e[18]},"1f":{dia:e[19],hora:e[20],aula:e[21]},"2f":{dia:e[22],hora:e[23],aula:e[24]},lunes:{aula:e[25],horario:e[26]},martes:{aula:e[27],horario:e[28]},miercoles:{aula:e[29],horario:e[30]},jueves:{aula:e[31],horario:e[32]},viernes:{aula:e[33],horario:e[34]},sabado:{aula:e[35],horario:e[36],noche:""}})}),t}(e),console.log("toCalendar",e),window.localStorage.clear(),window.localStorage.toInicio=JSON.stringify(e)}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(b.a),l.Lb(o.a),l.Lb(c.g))},e.\u0275cmp=l.Fb({type:e,selectors:[["app-cargar-horario"]],decls:10,vars:5,consts:[[4,"ngIf"],["slot","end","button","",3,"click",4,"ngIf"],["slot","start","button","",3,"click",4,"ngIf"],["id","file-input","type","file","multiple","false",2,"display","none",3,"change"],[4,"ngFor","ngForOf"],["slot","start",3,"ngModel","ngModelChange","ionChange"],[1,"ion-align-self-end"],["slot","start",1,"ion-no-padding","ion-no-margin",3,"ngModel","indeterminate","ngModelChange","click"],["slot","start","name","none"],["slot","start",3,"ngModel","ngModelChange"],["slot","end","button","",3,"click"],["name","caret-forward","size","large"],["slot","start","button","",3,"click"],["name","caret-back","size","large"]],template:function(e,t){1&e&&(l.Mb(0,"app-header"),l.Mb(1,"app-menu"),l.mc(2,f,2,1,"ion-content",0),l.mc(3,C,2,1,"ion-content",0),l.mc(4,k,2,1,"ion-content",0),l.Qb(5,"ion-footer"),l.Qb(6,"ion-toolbar"),l.mc(7,Q,4,0,"ion-item",1),l.mc(8,S,4,0,"ion-item",2),l.Pb(),l.Qb(9,"input",3),l.Yb("change",(function(e){return t.onFileChange(e)})),l.Pb(),l.Pb()),2&e&&(l.zb(2),l.fc("ngIf",1==t.currentSection.number),l.zb(1),l.fc("ngIf",2==t.currentSection.number),l.zb(1),l.fc("ngIf",3==t.currentSection.number),l.zb(3),l.fc("ngIf",t.currentSection.nextPageVisibility),l.zb(1),l.fc("ngIf",t.currentSection.nextPageVisibility))},directives:[h.a,u.a,i.j,o.l,o.C,o.h,i.i,o.s,o.q,o.r,o.f,o.b,s.d,s.e,o.m,o.w,o.o],styles:[""]}),e})()}];let y=(()=>{class e{}return e.\u0275mod=l.Jb({type:e}),e.\u0275inj=l.Ib({factory:function(t){return new(t||e)},imports:[[c.i.forChild(w)],c.i]}),e})();var z=n("lSLK");let I=(()=>{class e{}return e.\u0275mod=l.Jb({type:e}),e.\u0275inj=l.Ib({factory:function(t){return new(t||e)},imports:[[i.b,s.a,o.D,y,z.a]]}),e})()}}]);